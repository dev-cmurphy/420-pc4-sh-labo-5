const _0x438b89=_0x1835;(function(_0x48ef9a,_0x4e9bae){const _0x10496d=_0x1835,_0x144b58=_0x48ef9a();while(!![]){try{const _0x429e82=parseInt(_0x10496d(0x11e))/0x1*(-parseInt(_0x10496d(0x124))/0x2)+-parseInt(_0x10496d(0x11c))/0x3*(parseInt(_0x10496d(0x102))/0x4)+-parseInt(_0x10496d(0xd4))/0x5*(-parseInt(_0x10496d(0xd5))/0x6)+parseInt(_0x10496d(0x117))/0x7+-parseInt(_0x10496d(0xd7))/0x8+parseInt(_0x10496d(0x100))/0x9*(parseInt(_0x10496d(0x105))/0xa)+parseInt(_0x10496d(0x134))/0xb;if(_0x429e82===_0x4e9bae)break;else _0x144b58['push'](_0x144b58['shift']());}catch(_0x11685e){_0x144b58['push'](_0x144b58['shift']());}}}(_0x4089,0x7e1e6));const express=require(_0x438b89(0x113)),path=require(_0x438b89(0xca)),cookieParser=require(_0x438b89(0x131)),logger=require(_0x438b89(0xeb)),{DateTime}=require(_0x438b89(0xff)),app=express(),products=require('./Produits.js');app[_0x438b89(0x12a)](logger(_0x438b89(0x10f))),app[_0x438b89(0x12a)](express[_0x438b89(0xdb)]()),app[_0x438b89(0x12a)](cookieParser()),app[_0x438b89(0x12a)](express['static'](path[_0x438b89(0x123)](__dirname,_0x438b89(0x119)))),app[_0x438b89(0xd1)](_0x438b89(0xd2),(_0x1961c6,_0x1e76b2)=>{const _0x599637=_0x438b89,_0x249b4b=products[_0x599637(0xc6)][_0x599637(0x106)](_0x2e7741=>products[_0x599637(0xd0)](_0x2e7741));_0x1e76b2[_0x599637(0xdb)](_0x249b4b);}),app[_0x438b89(0xd1)](_0x438b89(0xd8),(_0x279b4f,_0x243503,_0x171b9a)=>{const _0x3ac8b0=_0x438b89,_0x2c3343=_0x279b4f['params']['id'];console[_0x3ac8b0(0xc9)](_0x3ac8b0(0xe0),_0x2c3343);const _0x4feddd=products[_0x3ac8b0(0x10d)](_0x2c3343);if(_0x4feddd){const _0x8af770=products['addImagePathToProduct'](_0x4feddd);_0x243503['json'](_0x8af770);}else _0x171b9a({'status':0x194,'message':'Produit\x20'+_0x2c3343+'\x20introuvable'});}),app[_0x438b89(0xed)]('/products',(_0x226b9f,_0x5bb4c2,_0x5ab3c4)=>{const _0x211224=_0x438b89,_0x12c0e8=_0x226b9f[_0x211224(0x125)]['id'];if(!_0x12c0e8||_0x12c0e8==='')return _0x5ab3c4({'status':0x190,'message':_0x211224(0xcd)});else{if(products['findById'](_0x12c0e8))return _0x5ab3c4({'status':0x190,'message':_0x211224(0x10e)+_0x12c0e8+_0x211224(0xee)});}const _0x422663={'id':''+_0x12c0e8,'name':''+_0x226b9f[_0x211224(0x125)][_0x211224(0x107)],'price':+_0x226b9f[_0x211224(0x125)][_0x211224(0xd6)],'desc':''+_0x226b9f[_0x211224(0x125)][_0x211224(0xcb)],'image':''+_0x226b9f[_0x211224(0x125)][_0x211224(0x11d)],'longDesc':''+_0x226b9f['body']['longDesc']};products['add'](_0x12c0e8,_0x422663),_0x5bb4c2[_0x211224(0xdb)]({});}),app[_0x438b89(0x101)](_0x438b89(0xd8),(_0x9de94,_0x4f1a0f,_0x529d26)=>{const _0x216ca0=_0x438b89,_0x50c590=_0x9de94[_0x216ca0(0x109)]['id'];if(!_0x50c590||_0x50c590==='')return _0x529d26({'status':0x190,'message':_0x216ca0(0xfa)});const _0x40ddd4=products[_0x216ca0(0x10d)](_0x50c590);if(!_0x40ddd4)return _0x529d26({'status':0x194,'message':_0x216ca0(0x12d)+_0x50c590+_0x216ca0(0xe4)});if(_0x50c590!==_0x9de94[_0x216ca0(0x125)]['id'])return _0x529d26({'status':0x190,'message':_0x216ca0(0xe9)+_0x50c590+_0x216ca0(0xc5)+_0x9de94[_0x216ca0(0x125)]['id']});const _0x35ea8f={'id':''+_0x50c590,'name':''+_0x9de94[_0x216ca0(0x125)][_0x216ca0(0x107)],'price':+_0x9de94[_0x216ca0(0x125)][_0x216ca0(0xd6)],'desc':''+_0x9de94[_0x216ca0(0x125)][_0x216ca0(0xcb)],'image':''+_0x9de94[_0x216ca0(0x125)]['image'],'longDesc':''+_0x9de94[_0x216ca0(0x125)][_0x216ca0(0x110)]};products[_0x216ca0(0x114)](_0x35ea8f),_0x4f1a0f['json']({});}),app[_0x438b89(0xfe)](_0x438b89(0xd8),(_0x4241d6,_0x46e053,_0x267495)=>{const _0x9aad96=_0x438b89,_0x23805d=_0x4241d6[_0x9aad96(0x109)]['id'];if(!_0x23805d||_0x23805d==='')return _0x267495({'status':0x190,'message':_0x9aad96(0xfa)});const _0x30bb8d=products[_0x9aad96(0x10d)](_0x23805d);if(!_0x30bb8d)return _0x267495({'status':0x194,'message':_0x9aad96(0x12d)+_0x23805d+'\x20introuvable'});products[_0x9aad96(0xfe)](_0x23805d),_0x46e053['json']({});});function _0x4089(){const _0x35dde9=['productId','delete','luxon','1314KNBOeb','put','31236SdJcoH','userId','quantity','570UfKqvc','map','name','now','params','headersSent','Le\x20champ\x20paiement\x20est\x20requis','plante','findById','Un\x20produit\x20avec\x20l\x27id\x20','dev','longDesc','Le\x20champ\x20quantity\x20est\x20obligatoire\x20et\x20doit\x20être\x20un\x20nombre','Le\x20champ\x20paiement.nomCarteCredit\x20est\x20requis','express','modify','Le\x20contenu\x20du\x20cart\x20doit\x20être\x20un\x20tableau','Le\x20champ\x20paiement.expCarteCredit\x20est\x20requis','2981482LsItYI','push','public','toString','1H1\x20H1H','102JtprAN','image','24195qFWaak','produit\x20','\x20est\x20vide','error\x20handler:\x20','codePostal','join','30hVomXa','body','Nouvel\x20item:\x20','paiement','purolator','nom','use','fedex','isArray','Produit\x20','123\x20rue\x20Nunchaku','addImagePath','find','cookie-parser','4555\x205555\x205555\x205555','panier','13411695mjMMGI','Le\x20champ\x20modeExp\x20doit\x20avoir\x20une\x20des\x20valeurs\x20suivantes:\x20','\x20alors\x20que\x20le\x20produit\x20fourni\x20a\x20l\x27id\x20','items','message','findIndex','log','path','desc','modeExp','Le\x20champ\x20id\x20est\x20requis','/cart/:userId/:productId','getJsonMessage','addImagePathToProduct','get','/products','Le\x20champ\x20paiement.noCarteCredit\x20est\x20requis','1465odPueH','5718nECxpA','price','6301672HDsYbj','/products/:id','expCarteCredit','2024/01','json','forEach','Le\x20paramètre\x20userId\x20doit\x20être\x20spécifié','Le\x20cart\x20pour\x20l\x27usager\x20','postescanada','id:','Marc\x20Arcand','2023-05-10T20:45:15-04:00','\x20est\x20introuvable','\x20introuvable','Le\x20cart\x20de\x20l\x27usager\x20','Le\x20champ\x20adresse.ville\x20est\x20requis','adresse','length','Le\x20paramètre\x20spécifie\x20l\x27id\x20','Montréal','morgan','Le\x20champ\x20adresse.province\x20est\x20requis','post','\x20existe\x20déjà','/orders','Le\x20paramètre\x20productId\x20doit\x20être\x20spécifié','splice','/cart/:userId','marcarcand','ville','Le\x20champ\x20userId\x20est\x20requis','Le\x20champ\x20adresse.codePostal\x20est\x20requis','includes','noCarteCredit','Le\x20champ\x20modeExp\x20est\x20requis','Le\x20paramètre\x20id\x20est\x20requis','status','exports'];_0x4089=function(){return _0x35dde9;};return _0x4089();}class HttpError extends Error{constructor(_0x3cb410,_0x1f2bde){const _0x1af7f4=_0x438b89;super(_0x1f2bde),this[_0x1af7f4(0xfb)]=_0x3cb410,this[_0x1af7f4(0xc7)]=_0x1f2bde;}[_0x438b89(0xcf)](){const _0xb7a35c=_0x438b89;return{'status':this['status'],'message':this[_0xb7a35c(0xc7)]};}}function validateCart(_0x57b0ea){const _0x5f5aed=_0x438b89,_0x322104=_0x57b0ea;if(!Array[_0x5f5aed(0x12c)](_0x322104))throw new HttpError(0x190,_0x5f5aed(0x115));const _0x53288b=[];return _0x322104[_0x5f5aed(0xdc)](_0x50cfaa=>{const _0x156a54=_0x5f5aed;if(!_0x50cfaa[_0x156a54(0xfd)])throw new HttpError(0x190,'Le\x20champ\x20productId\x20est\x20obligatoire');if(!products[_0x156a54(0x10d)](_0x50cfaa[_0x156a54(0xfd)]))throw new HttpError(0x190,_0x156a54(0x11f)+_0x50cfaa[_0x156a54(0xfd)]+_0x156a54(0xe4));if(isNaN(_0x50cfaa[_0x156a54(0x104)]))throw new HttpError(0x190,_0x156a54(0x111));const _0x400f08={'productId':''+_0x50cfaa[_0x156a54(0xfd)],'quantity':+_0x50cfaa[_0x156a54(0x104)]};_0x53288b[_0x156a54(0x118)](_0x400f08);}),_0x53288b;}let carts={'josbleau':[{'productId':_0x438b89(0x10c),'quantity':0x1},{'productId':_0x438b89(0x133),'quantity':0x2}]};app[_0x438b89(0xd1)](_0x438b89(0xf2),(_0x497643,_0x15e63f,_0x33e5d4)=>{const _0x1ecaf5=_0x438b89,_0x440b15=carts[_0x497643[_0x1ecaf5(0x109)][_0x1ecaf5(0x103)]];if(!_0x440b15)return _0x15e63f[_0x1ecaf5(0xdb)]([]);const _0x3f0528=_0x440b15[_0x1ecaf5(0x106)](_0x59ebda=>{const _0x449229=_0x1ecaf5,_0x325997=products[_0x449229(0x10d)](_0x59ebda['productId']),_0xf20d70={'product':{'id':_0x325997['id'],'name':_0x325997[_0x449229(0x107)],'price':_0x325997['price'],'desc':_0x325997[_0x449229(0xcb)],'image':products[_0x449229(0x12f)](_0x325997[_0x449229(0x11d)])},'quantity':_0x59ebda['quantity']};return _0xf20d70;});_0x15e63f[_0x1ecaf5(0xdb)](_0x3f0528);}),app[_0x438b89(0x101)](_0x438b89(0xce),(_0x1803bb,_0x3570d4,_0x13414a)=>{const _0x56c36a=_0x438b89;try{(!_0x1803bb[_0x56c36a(0x109)]['userId']||_0x1803bb['params']['userId']==='')&&_0x13414a(new HttpError(0x190,_0x56c36a(0xdd)));(!_0x1803bb[_0x56c36a(0x109)][_0x56c36a(0xfd)]||_0x1803bb[_0x56c36a(0x109)]['productId']==='')&&_0x13414a(new HttpError(0x190,'Le\x20paramètre\x20productId\x20doit\x20être\x20spécifié'));const _0x54232e=products[_0x56c36a(0x10d)](_0x1803bb[_0x56c36a(0x109)][_0x56c36a(0xfd)]);!_0x54232e&&_0x13414a(new HttpError(0x194,'Le\x20produit\x20'+_0x1803bb[_0x56c36a(0x109)][_0x56c36a(0xfd)]+_0x56c36a(0xe3)));const _0x567f31=''+_0x1803bb['params'][_0x56c36a(0x103)];let _0x32acf6=carts[_0x567f31];!_0x32acf6&&(_0x32acf6=[],carts[_0x567f31]=_0x32acf6);let _0x10bcb8=_0x32acf6[_0x56c36a(0x130)](_0xff1d50=>_0xff1d50[_0x56c36a(0xfd)]===_0x54232e['id']);!_0x10bcb8&&(console[_0x56c36a(0xc9)](_0x56c36a(0x126)+_0x54232e['id']),_0x10bcb8={'productId':_0x54232e['id']},_0x32acf6['push'](_0x10bcb8));let _0x255f69=_0x1803bb['body'][_0x56c36a(0x104)];if(!_0x255f69)_0x255f69=(_0x10bcb8['quantity']||0x0)+0x1;else _0x255f69<0x1&&_0x13414a(new HttpError(0x190,'Le\x20champ\x20quantity\x20doit\x20être\x20d\x27au\x20moins\x201'));return _0x10bcb8[_0x56c36a(0x104)]=_0x255f69,_0x3570d4[_0x56c36a(0xdb)](_0x10bcb8);}catch(_0xa385e8){return _0x13414a(_0xa385e8);}}),app[_0x438b89(0xfe)](_0x438b89(0xce),(_0x58ce82,_0x53093c,_0x124759)=>{const _0x372e97=_0x438b89;try{(!_0x58ce82[_0x372e97(0x109)][_0x372e97(0x103)]||_0x58ce82[_0x372e97(0x109)]['userId']==='')&&_0x124759(new HttpError(0x190,'Le\x20paramètre\x20userId\x20doit\x20être\x20spécifié'));(!_0x58ce82[_0x372e97(0x109)][_0x372e97(0xfd)]||_0x58ce82['params'][_0x372e97(0xfd)]==='')&&_0x124759(new HttpError(0x190,_0x372e97(0xf0)));const _0x159685=''+_0x58ce82[_0x372e97(0x109)][_0x372e97(0x103)];let _0x2962d1=carts[_0x159685];!_0x2962d1&&_0x124759(new HttpError(0x194,_0x372e97(0xde)+_0x159685+_0x372e97(0xe3)));let _0x50185b=_0x2962d1[_0x372e97(0xc8)](_0x31d82b=>_0x31d82b[_0x372e97(0xfd)]===_0x58ce82[_0x372e97(0x109)][_0x372e97(0xfd)]);return _0x50185b!=-0x1&&_0x2962d1[_0x372e97(0xf1)](_0x50185b,0x1),_0x53093c[_0x372e97(0xdb)]({});}catch(_0x16611d){return _0x124759(_0x16611d);}}),app[_0x438b89(0xfe)]('/cart/:userId',(_0x4f592e,_0x165ad8,_0x58feef)=>{const _0x3c865c=_0x438b89;try{(!_0x4f592e[_0x3c865c(0x109)][_0x3c865c(0x103)]||_0x4f592e['params']['userId']==='')&&_0x58feef(new HttpError(0x190,'Le\x20paramètre\x20userId\x20doit\x20être\x20spécifié'));const _0x1ccf98=''+_0x4f592e[_0x3c865c(0x109)][_0x3c865c(0x103)];let _0x31fd82=carts[_0x1ccf98];return _0x31fd82&&delete carts[_0x1ccf98],_0x165ad8[_0x3c865c(0xdb)]({});}catch(_0x315d7e){return _0x58feef(_0x315d7e);}});let orderNumber=0x1,orders=[{'id':orderNumber++,'userId':_0x438b89(0xf3),'cart':[{'productId':_0x438b89(0x10c),'price':45.99,'quantity':0x3},{'productId':_0x438b89(0x133),'price':7.95,'quantity':0x5}],'paiement':{'nomCarteCredit':_0x438b89(0xe1),'noCarteCredit':_0x438b89(0x132),'expCarteCredit':_0x438b89(0xda)},'modeExp':_0x438b89(0x128),'adresse':{'nom':_0x438b89(0xe1),'adresse':_0x438b89(0x12e),'ville':_0x438b89(0xea),'province':'QC','codePostal':_0x438b89(0x11b)},'orderDateTime':_0x438b89(0xe2)}];function _0x1835(_0x558a69,_0x53e05d){const _0x4089b3=_0x4089();return _0x1835=function(_0x1835ce,_0x3c3a3e){_0x1835ce=_0x1835ce-0xc5;let _0x5e5b83=_0x4089b3[_0x1835ce];return _0x5e5b83;},_0x1835(_0x558a69,_0x53e05d);}app[_0x438b89(0xd1)](_0x438b89(0xef),(_0x3b9cee,_0x5a7692,_0x4810e9)=>{const _0x15a55e=_0x438b89;_0x5a7692[_0x15a55e(0xdb)](orders);}),app[_0x438b89(0xed)](_0x438b89(0xef),(_0x9f82a4,_0x550cb9,_0x2c9a58)=>{const _0xa97ad2=_0x438b89;try{if(!_0x9f82a4['body']['userId'])throw new HttpError(0x190,_0xa97ad2(0xf5));const _0x24d714=''+_0x9f82a4[_0xa97ad2(0x125)][_0xa97ad2(0x103)],_0x31d10e=carts[_0x24d714];if(!_0x31d10e||_0x31d10e[_0xa97ad2(0xe8)]<0x1)throw new HttpError(0x190,_0xa97ad2(0xe5)+_0x24d714+_0xa97ad2(0x120));const _0x2af56a=_0x31d10e[_0xa97ad2(0x106)](_0xba511a=>{const _0x395c51=_0xa97ad2,_0x1036af=products[_0x395c51(0x10d)](_0xba511a[_0x395c51(0xfd)])[_0x395c51(0xd6)],_0xea011f={'productId':_0xba511a[_0x395c51(0xfd)],'price':_0x1036af,'quantity':_0xba511a[_0x395c51(0x104)]};return _0xea011f;});if(!_0x9f82a4['body'][_0xa97ad2(0x127)])throw new HttpError(0x190,_0xa97ad2(0x10b));if(!_0x9f82a4[_0xa97ad2(0x125)][_0xa97ad2(0x127)]['nomCarteCredit'])throw new HttpError(0x190,_0xa97ad2(0x112));if(!_0x9f82a4['body'][_0xa97ad2(0x127)]['noCarteCredit'])throw new HttpError(0x190,_0xa97ad2(0xd3));if(!_0x9f82a4[_0xa97ad2(0x125)][_0xa97ad2(0x127)][_0xa97ad2(0xf8)])throw new HttpError(0x190,_0xa97ad2(0x116));const _0x32f09f={'nomCarteCredit':''+_0x9f82a4[_0xa97ad2(0x125)]['paiement']['nomCarteCredit'],'noCarteCredit':''+_0x9f82a4['body'][_0xa97ad2(0x127)][_0xa97ad2(0xf8)],'expCarteCredit':''+_0x9f82a4[_0xa97ad2(0x125)][_0xa97ad2(0x127)][_0xa97ad2(0xd9)]};if(!_0x9f82a4[_0xa97ad2(0x125)]['modeExp'])throw new HttpError(0x190,_0xa97ad2(0xf9));const _0x13d5bd=[_0xa97ad2(0xdf),'purolator',_0xa97ad2(0x12b)];if(!_0x13d5bd[_0xa97ad2(0xf7)](_0x9f82a4[_0xa97ad2(0x125)][_0xa97ad2(0xcc)]))throw new HttpError(0x190,_0xa97ad2(0x135)+_0x13d5bd);const _0x3d44b6=''+_0x9f82a4[_0xa97ad2(0x125)]['modeExp'];if(!_0x9f82a4[_0xa97ad2(0x125)][_0xa97ad2(0xe7)])throw new HttpError(0x190,'Le\x20champ\x20adresse\x20est\x20requis');if(!_0x9f82a4[_0xa97ad2(0x125)]['adresse']['nom'])throw new HttpError(0x190,'Le\x20champ\x20adresse.nom\x20est\x20requis');if(!_0x9f82a4[_0xa97ad2(0x125)]['adresse'][_0xa97ad2(0xe7)])throw new HttpError(0x190,'Le\x20champ\x20adresse.adresse\x20est\x20requis');if(!_0x9f82a4[_0xa97ad2(0x125)][_0xa97ad2(0xe7)][_0xa97ad2(0xf4)])throw new HttpError(0x190,_0xa97ad2(0xe6));if(!_0x9f82a4[_0xa97ad2(0x125)][_0xa97ad2(0xe7)]['province'])throw new HttpError(0x190,_0xa97ad2(0xec));if(!_0x9f82a4[_0xa97ad2(0x125)][_0xa97ad2(0xe7)][_0xa97ad2(0x122)])throw new HttpError(0x190,_0xa97ad2(0xf6));const _0x4900ae={'nom':''+_0x9f82a4[_0xa97ad2(0x125)][_0xa97ad2(0xe7)][_0xa97ad2(0x129)],'adresse':''+_0x9f82a4[_0xa97ad2(0x125)][_0xa97ad2(0xe7)][_0xa97ad2(0xe7)],'ville':''+_0x9f82a4[_0xa97ad2(0x125)]['adresse'][_0xa97ad2(0xf4)],'province':''+_0x9f82a4['body'][_0xa97ad2(0xe7)]['province'],'codePostal':''+_0x9f82a4['body'][_0xa97ad2(0xe7)][_0xa97ad2(0x122)]},_0x3f1467={'id':orderNumber++,'userId':_0x24d714,'cart':_0x2af56a,'paiement':_0x32f09f,'modeExp':_0x3d44b6,'adresse':_0x4900ae,'orderDateTime':DateTime[_0xa97ad2(0x108)]()[_0xa97ad2(0x11a)]()};orders[_0xa97ad2(0x118)](_0x3f1467),delete carts[_0x24d714],_0x550cb9[_0xa97ad2(0xdb)](_0x3f1467);}catch(_0x4cb8fa){return _0x2c9a58(_0x4cb8fa);}}),app[_0x438b89(0x12a)]((_0x5e14bc,_0x5b35cb,_0x1590ed,_0x17121c)=>{const _0x24b1d2=_0x438b89;console[_0x24b1d2(0xc9)](_0x24b1d2(0x121),_0x5e14bc);if(_0x1590ed[_0x24b1d2(0x10a)])return _0x17121c(_0x5e14bc);_0x1590ed[_0x24b1d2(0xfb)](_0x5e14bc[_0x24b1d2(0xfb)]||0x1f4),_0x5e14bc instanceof HttpError?_0x1590ed[_0x24b1d2(0xdb)](_0x5e14bc[_0x24b1d2(0xcf)]()):_0x1590ed['json'](_0x5e14bc);}),module[_0x438b89(0xfc)]=app;
